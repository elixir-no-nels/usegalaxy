- hosts: test-slurm.usegalaxy.no
#  gather_facts: False
#  connection: local
  vars:
      tooldir: "{{ansible_env.HOME}}/files/galaxy/tools"
      galaxy_tools_tool_list_files: [ "files/galaxy/tools/tools_list.yml" ]
      galaxy_tools_workflows: [ "files/galaxy/tools/workflows.ga" ]
      galaxy_tools_data_managers_list: "files/galaxy/tools/dbkeys_list.yml"
      galaxy_tools_install_tools: yes
      galaxy_tools_install_data_managers: yes
      galaxy_tools_install_workflows: yes
      galaxy_tools_galaxy_instance_url: https://test.usegalaxy.no/
      galaxy_tools_api_key: "{{galaxy_master_api_key}}"

  pre_tasks:
    - name: Install required packages
      become: true
      package:
        name:
          - python-virtualenv
    - name: Create Folder
      file:
        path: "{{ tooldir }}"
        mode: 0755 
        state: directory
    - name: Copy tools list
      synchronize:
        src: files/galaxy/tools/
        dest: "{{ tooldir }}"

  roles:
      - usegalaxy.galaxy-tools
